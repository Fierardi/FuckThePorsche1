<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="Images/Icon.png" type="image/png">
  <title>NapoliGames - Chat</title>
  
  <!-- External Libraries -->
  <script src="https://cdn.ably.io/lib/ably.min-1.js"></script>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600&display=swap" rel="stylesheet" />
    
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WGE5P95VRW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-WGE5P95VRW');
  </script>

  <!-- External Stylesheets -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="chat.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <a href="index.html" class="logo-link">NapoliGames</a>
    </div> 
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="games.html">Games</a>
      <a href="updates.html">Updates</a>
      <a href="#" id="login-btn">Account</a>
    </div>
  </header>

  <main>
    <h1>Napoli-Chat</h1>

    <div class="username">
      <div id="user-display"></div>
      <div id="login-prompt" class="login-prompt" style="display: none;">
        <div>Please log in to participate in the chat</div>
        <button class="login-button" onclick="window.netlifyIdentity.open()">Login / Sign Up</button>
      </div>
    </div>

    <div class="chat-layout">
      <div class="sidebar">
        <div class="sidebar-header">
          <div class="chat-tabs">
            <button class="tab-btn active" data-tab="public">Public</button>
            <button class="tab-btn" data-tab="private" id="privateTabBtn">
              Private 
              <span id="privateNotificationBadge" class="tab-notification-badge" style="display: none;">0</span>
            </button>
          </div>
          <div id="userInfoSection" class="user-info-section" style="display: none;">
            <h4>Your Username:</h4>
            <div class="username-display" id="usernameDisplay"></div>
            <small style="color: #666; font-size: 0.75rem;">Share this with friends to connect!</small>
          </div>
          <input type="text" class="user-search" id="userSearch" placeholder="Search users by name..." style="display: none;">
        </div>
        <div class="chat-list" id="chatList">
          <!-- Chat items will be populated here -->
        </div>
      </div>

      <div id="chat-container">
        <div class="chat-header">
          <h3 id="chatTitle">Public Chat</h3>
        </div>
        <div id="chat"></div>
        <div class="typing-indicator" id="typingIndicator">Someone is typing...</div>
        <div class="input-row">
          <input type="file" id="imageInput" class="file-input" accept="image/*,audio/*,video/*,.pdf,.doc,.docx">
          <button class="file-button" id="fileBtn" disabled title="Attach file">ðŸ“Ž</button>
          <button class="audio-button" id="audioBtn" disabled title="Record voice message">ðŸŽ¤</button>
          <div class="input-container">
            <input type="text" id="msg" placeholder="Type a message..." disabled />
            <img id="imagePreview" style="display:none; max-width:120px; max-height:120px; border-radius:10px; margin-top:4px;" />
          </div>
          <button id="send" class="send-btn" disabled>Send</button>
        </div>
      </div>
    </div>
  </main>

  <!-- Image Modal -->
  <div id="imageModal" class="image-modal">
    <div class="image-modal-content">
      <span class="image-modal-close">&times;</span>
      <img id="modalImage" src="" alt="">
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-links">
      <a href="#">Privacy Policy</a>
      <a href="#">Terms of Service</a>
      <a href="#">Contact Us</a>
      <a href="#">About</a>
    </div>
    <p>Copyright &copy; 2025 NapoliGames. All rights reserved.</p>
  </footer>

  <!-- External JavaScript -->
  <script src="chat.js"></script>
</body>
</html>